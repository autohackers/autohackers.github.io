<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CrikeyCon CTF - Carhacky Content</title>
    <link rel="stylesheet" href="/assets/built/screen.css?v=5062ac6034">

    <meta name="description" content="Ever wanted to hack the CAN data of a Porsche 911?">
    <link rel="icon" href="https://autohackers.org/content/images/size/w256h256/2023/05/android-chrome-192x192.png" type="image/png">
    <link rel="canonical" href="https://autohackers.org/content-for-crikeycon8-ctf/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Autohackers">
    <meta property="og:type" content="article">
    <meta property="og:title" content="CrikeyCon CTF - Carhacky Content">
    <meta property="og:description" content="Ever wanted to hack the CAN data of a Porsche 911?">
    <meta property="og:url" content="https://autohackers.org/content-for-crikeycon8-ctf/">
    <meta property="og:image" content="https://autohackers.org/content/images/2022/09/IMG_5381_1000px.jpg">
    <meta property="article:published_time" content="2022-09-01T10:53:48.000Z">
    <meta property="article:modified_time" content="2022-09-01T10:53:48.000Z">
    <meta property="article:tag" content="News">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CrikeyCon CTF - Carhacky Content">
    <meta name="twitter:description" content="Ever wanted to hack the CAN data of a Porsche 911?">
    <meta name="twitter:url" content="https://autohackers.org/content-for-crikeycon8-ctf/">
    <meta name="twitter:image" content="https://autohackers.org/content/images/2022/09/IMG_5381_1000px.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="2pucks">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="News">
    <meta name="twitter:site" content="@autohackers">
    <meta property="og:image:width" content="1000">
    <meta property="og:image:height" content="626">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Autohackers",
        "url": "https://autohackers.org/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://autohackers.org/content/images/2023/05/ah-text-bw.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "2pucks",
        "image": {
            "@type": "ImageObject",
            "url": "https://autohackers.org/content/images/2022/08/2pucks_thumb.png",
            "width": 666,
            "height": 375
        },
        "url": "https://autohackers.org/author/2pucks/",
        "sameAs": []
    },
    "headline": "CrikeyCon CTF - Carhacky Content",
    "url": "https://autohackers.org/content-for-crikeycon8-ctf/",
    "datePublished": "2022-09-01T10:53:48.000Z",
    "dateModified": "2022-09-01T10:53:48.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://autohackers.org/content/images/2022/09/IMG_5381_1000px.jpg",
        "width": 1000,
        "height": 626
    },
    "keywords": "News",
    "description": "Ever wanted to hack the CAN data of a Porsche 911?",
    "mainEntityOfPage": "https://autohackers.org/content-for-crikeycon8-ctf/"
}
    </script>

    <meta name="generator" content="Ghost 5.49">
    <link rel="alternate" type="application/rss+xml" title="Autohackers" href="https://autohackers.org/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="c6912a0f6252116374e0ccdb97" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://autohackers.org/" crossorigin="anonymous"></script>
    
    <link href="https://autohackers.org/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=5062ac6034"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=5062ac6034">
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FHH95SW8NY">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

 

  gtag('config', 'G-FHH95SW8NY');
</script><style>:root {--ghost-accent-color: #22366b;}</style>
</head>

<body class="post-template tag-news is-head-middle-logo">
<div class="gh-site">

    <header id="gh-head" class="gh-head gh-outer">
        <div class="gh-head-inner gh-inner">
            <div class="gh-head-brand">
                <div class="gh-head-brand-wrapper">
                    
                    <a class="gh-head-logo" href="https://autohackers.org">
                            <img src="https://autohackers.org/content/images/2023/05/ah-text-bw.png" alt="Autohackers">
                    </a>
                    
                </div>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://autohackers.org/">Home</a></li>
    <li class="nav-conference"><a href="https://autohackers.org/autohackers2023/">Conference</a></li>
    <li class="nav-about"><a href="https://autohackers.org/about/">About</a></li>
    <li class="nav-mastodon"><a href="https://infosec.exchange/@autohackers">Mastodon</a></li>
    <li class="nav-github"><a href="https://github.com/autohackers">Github</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                        <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
            </div>
        </div>
    </header>

    
<main class="gh-main">
        <article class="gh-article post tag-news">

            <header class="gh-article-header gh-canvas">
                    <a class="gh-article-tag" href="https://autohackers.org/tag/news/">News</a>

                <h1 class="gh-article-title">CrikeyCon CTF - Carhacky Content</h1>

                    <aside class="gh-article-sidebar">

        <div class="gh-author-image-list">
                <a class="gh-author-image" href="/author/2pucks/">
                        <img src="https://autohackers.org/content/images/2022/08/2pucks_thumb.png" alt="2pucks">
                </a>
        </div>

        <div class="gh-author-name-list">
                <h4 class="gh-author-name">
                    <a href="/author/2pucks/">2pucks</a>
                </h4>
                
        </div>

        <div class="gh-article-meta">
            <div class="gh-article-meta-inner">
                <time class="gh-article-date" datetime="2022-09-01">Sep 1, 2022</time>
                    <span class="gh-article-meta-sep"></span>
                    <span class="gh-article-length">3 min</span>
            </div>
        </div>

    </aside>

                    <p class="gh-article-excerpt">Ever wanted to hack the CAN data of a Porsche 911?</p>

                    <figure class="gh-article-image">
        <img
            srcset="/content/images/size/w300/2022/09/IMG_5381_1000px.jpg 300w,
                    /content/images/size/w720/2022/09/IMG_5381_1000px.jpg 720w,
                    /content/images/size/w960/2022/09/IMG_5381_1000px.jpg 960w,
                    /content/images/size/w1200/2022/09/IMG_5381_1000px.jpg 1200w,
                    /content/images/size/w2000/2022/09/IMG_5381_1000px.jpg 2000w"
            sizes="(max-width: 1200px) 100vw, 1200px"
            src="/content/images/size/w1200/2022/09/IMG_5381_1000px.jpg"
            alt="CrikeyCon CTF - Carhacky Content"
        >
            <figcaption>Porsche 911 40Jahre edition badge</figcaption>
    </figure>
            </header>

            <section class="gh-content gh-canvas">
                <p>Have you <strong>ever wanted to hack the CAN data of a Porsche 911</strong>? </p><p>The following is the background you might want if you're trying the CrikeyCon CTF car hacking challenges... then you can have a go at data recorded directly from the CAN bus of a 911 and make real-time changes to what the instrument cluster is showing you.</p><h3 id="contextwhere-the-can-bus-data-came-from">Context - where the CAN bus data came from</h3><p>The data was collected using exactly the same Raspberry Pi4 + PICAN3 hat combination as is used in the challenge.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://autohackers.org/content/images/2022/09/image-1.png" class="kg-image" alt="Raspberry Pi 4 with PICAN3 hat" loading="lazy" width="2000" height="1500" srcset="https://autohackers.org/content/images/size/w600/2022/09/image-1.png 600w, https://autohackers.org/content/images/size/w1000/2022/09/image-1.png 1000w, https://autohackers.org/content/images/size/w1600/2022/09/image-1.png 1600w, https://autohackers.org/content/images/size/w2400/2022/09/image-1.png 2400w" sizes="(min-width: 720px) 720px"><figcaption>Raspberry Pi 4 with PICAN3 hat</figcaption></figure><p>This device was connected to the CAN bus of a <strong>2004 Porsche 996 "40th Anniversary Edition" vehicle</strong> - one of the earliest Porsche cars with a CAN bus controlling the engine as well as other functions throughout the car. The model belongs to the 996 "gen 2", "facelift" or 996.2 version of the 996, if you're searching for more data.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://autohackers.org/content/images/2022/09/image.png" class="kg-image" alt="image showing getting access to the engine management computer &amp; CAN bus in the back of the 996" loading="lazy" width="1000" height="750" srcset="https://autohackers.org/content/images/size/w600/2022/09/image.png 600w, https://autohackers.org/content/images/2022/09/image.png 1000w" sizes="(min-width: 720px) 720px"><figcaption>Getting access to the engine management computer &amp; CAN bus in the 996</figcaption></figure><p>It has an 'eGas' pedal connected to the instrument cluster, which in turn was connected to two CAN buses - one for the drive-train and one for 'comfort' (Porsche's word for climate control and entertainment systems). Having two buses keeps the important traffic like accelerator &amp; brakes separate from the non-important traffic, like what the air conditioning is doing. (There is some overlap, as the a/c will trigger the compressor which does alter what the engine is doing... but this is controlled by the instrument cluster which is connected to both CAN buses.)</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://autohackers.org/content/images/2022/09/image-2.png" class="kg-image" alt="Bosch 'Cartronic' unit" loading="lazy" width="1000" height="750" srcset="https://autohackers.org/content/images/size/w600/2022/09/image-2.png 600w, https://autohackers.org/content/images/2022/09/image-2.png 1000w" sizes="(min-width: 720px) 720px"><figcaption>Bosch 'Cartronic' unit</figcaption></figure><p>The capture of traffic was performed after tapping the CAN high and low wires (and getting decent grounding to the chassis of the car).</p><p>CAN dump log file is in <a href="https://github.com/autohackers/CrikeyCon8CTF?ref=ghost-autohackers.adrenalan.org">https://github.com/autohackers/CrikeyCon8CTF</a></p><p>The dump file shows the following:</p><ul><li>engine being started (and a pause while I'm "wow, this is working!")</li><li>reversing up/out of driveway</li><li>driving around our block</li><li>back into driveway and switching off engine</li></ul><hr><h3 id="instrument-cluster-for-playback">Instrument Cluster for playback</h3><p>The idea of the capture was to learn about the CAN bus traffic in the 996 and also to be able to replay it and see what we can tweak.</p><p>Unfortunately there aren't that many of this specific model in the whole world (just over 1200 accounted for - see <a href="https://www.40jahre911.com/?ref=ghost-autohackers.adrenalan.org">https://www.40jahre911.com/</a> if you're curious about the model) so finding any parts at a wrecker in Australia is kind of tough.</p><p>However I was able to locally(ish) source the instrument cluster from a similar vintage Porsche Boxter, that I know uses the same electronics gear, so I figured (honestly, made an "educated gamble") it would serve to replay the CAN traffic.🤞</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://autohackers.org/content/images/2022/09/image-4.png" class="kg-image" alt="Porsche Boxter Instrument Cluster (rear)" loading="lazy" width="1000" height="456" srcset="https://autohackers.org/content/images/size/w600/2022/09/image-4.png 600w, https://autohackers.org/content/images/2022/09/image-4.png 1000w" sizes="(min-width: 720px) 720px"><figcaption>Porsche Boxter Instrument Cluster (rear)</figcaption></figure><p>In case you're looking up details, the numbers from the dashboard above are Porsche: <strong>986 641 217 03</strong> FHB, type UK and VDO: 110.080.039/161</p><p>And, after figuring out the wiring of the connectors on the back of the cluster, a little wiring (you need +battery and +ignition for it to start accepting traffic) to hook the dashboard to a 12V supply and the CAN bus of the RPi, it worked!</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://autohackers.org/content/images/2022/09/image-5.png" class="kg-image" alt="Boxster instrument cluster replaying journey recorded in 996" loading="lazy" width="1000" height="526" srcset="https://autohackers.org/content/images/size/w600/2022/09/image-5.png 600w, https://autohackers.org/content/images/2022/09/image-5.png 1000w" sizes="(min-width: 720px) 720px"><figcaption>Boxster instrument cluster replaying journey recorded in 996</figcaption></figure><p>The final step was stopping the playback and seeing what items on the cluster could be directly addressed (or faked) using the CANsend tool. Some things, like the fuel gauge, are directly hooked up to sensors in the car (i.e. not the CAN bus). I managed to change data bound for the speedo, the tacho (RPM guage) and the engine temperature gauge. (I believe some other warning lights are also addressable but, at this point, I haven't found their identities - eg ABS &amp; traction control - as I haven't had the RPi secured well enough to, er, engage the traction control to the point it flashes a warning at me!)</p><p>Hence the CrikeyCon challenges available today are based on those three gauges. See the CTF board in the conference for more details... or come and see me at the car hacking desk! 😎</p><hr>
            </section>

        </article>

                <div class="gh-read-next gh-canvas">
                <section class="gh-pagehead">
                    <h4 class="gh-pagehead-title">Read next</h4>
                </section>

                <div class="gh-topic gh-topic-grid">
                    <div class="gh-topic-content">
                            <article class="gh-card post">
    <a class="gh-card-link" href="/crikeycon-background-reading/">
            <figure class="gh-card-image">
                <img
                    srcset="/content/images/size/w300/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg 300w,
                            /content/images/size/w720/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg 720w,
                            /content/images/size/w960/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg 960w,
                            /content/images/size/w1200/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg 1200w,
                            /content/images/size/w2000/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg 2000w"
                    sizes="(max-width: 1200px) 100vw, 1200px"
                    src="/content/images/size/w720/2022/08/jessica-ruscello-OQSCtabGkSY-unsplash.jpg"
                    alt="Photo of books in a library on end"
                >
            </figure>

        <div class="gh-card-wrapper">
            <header class="gh-card-header">
                <h3 class="gh-card-title">Background reading for CrikeyCon</h3>
            </header>

                    <div class="gh-card-excerpt">Background reading for CrikeyCon attendees if they want a better understanding of CAN bus.</div>

            <footer class="gh-card-footer">
                <span class="gh-card-author">2pucks</span>
                <time class="gh-card-date" datetime="2022-08-28">Aug 28, 2022</time>
            </footer>
        </div>
    </a>
</article>                            <article class="gh-card post">
    <a class="gh-card-link" href="/crikeycon_viii_ctf/">
            <figure class="gh-card-image">
                <img
                    srcset="/content/images/size/w300/2022/08/autohackers_ingredients_carhack-3.jpg 300w,
                            /content/images/size/w720/2022/08/autohackers_ingredients_carhack-3.jpg 720w,
                            /content/images/size/w960/2022/08/autohackers_ingredients_carhack-3.jpg 960w,
                            /content/images/size/w1200/2022/08/autohackers_ingredients_carhack-3.jpg 1200w,
                            /content/images/size/w2000/2022/08/autohackers_ingredients_carhack-3.jpg 2000w"
                    sizes="(max-width: 1200px) 100vw, 1200px"
                    src="/content/images/size/w720/2022/08/autohackers_ingredients_carhack-3.jpg"
                    alt="Raspberry Pi4 with PICAN3 hat, back of car instrument cluster with wires attached, keyboard and a coffee cup"
                >
            </figure>

        <div class="gh-card-wrapper">
            <header class="gh-card-header">
                <h3 class="gh-card-title">Autohackers @ CrikeyCon</h3>
            </header>

                    <div class="gh-card-excerpt">This year at CrikeyCon we’re starting with some basics – understanding the automotive CAN bus, with a capture from a vehicle and an instrument cluster from the same, to ‘replay’ the drive. See, learn and modify CAN traffic.</div>

            <footer class="gh-card-footer">
                <span class="gh-card-author">2pucks</span>
                <time class="gh-card-date" datetime="2022-08-26">Aug 26, 2022</time>
            </footer>
        </div>
    </a>
</article>                    </div>
                </div>
            </div>

        </main>

    <footer class="gh-foot gh-outer">
        <div class="gh-foot-inner gh-inner">

            <nav class="gh-foot-menu">
                
            </nav>

            <div class="gh-copyright">
                    Autohackers © 2023. Powered by <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a>
            </div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="/assets/built/main.min.js?v=5062ac6034"></script>



</body>

</html>
